# Application Configuration
spring.application.name=gateway
server.port=8080

# Netty Configuration
server.netty.connection-timeout=5000ms
server.compression.enabled=true
server.compression.min-response-size=1024

# Redis Configuration
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.timeout=2000ms
spring.redis.lettuce.pool.max-active=20
spring.redis.lettuce.pool.max-idle=10
spring.redis.lettuce.pool.min-idle=5

# Gateway HttpClient Configuration
spring.cloud.gateway.httpclient.connect-timeout=5000
spring.cloud.gateway.httpclient.response-timeout=30000

# Security - OAuth2 Configuration
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://auth-service:8001
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://auth-service:8001/.well-known/jwks.json

# JWT Secret (change in production!)
jwt.secret=my-super-secret-key-that-needs-to-be-at-least-32-characters-long

# eureka server config
eureka.client.service-url.defaultZone=http://localhost:8761/eureka

# Actuator Configuration
management.endpoints.web.exposure.include=health,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.tags.application=chat-gateway

# Tracing Configuration
management.tracing.sampling.probability=1.0

# Zipkin Configuration
management.zipkin.tracing.endpoint=http://localhost:9411/api/v2/spans
management.zipkin.tracing.enabled=true

# Logging Configuration
logging.level.root=INFO
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.org.springframework.security=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# Resilience4j Circuit Breaker Configuration
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.slidingWindowSize=100
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.minimumNumberOfCalls=10
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.waitDurationInOpenState=60s
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.failureRateThreshold=50
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.slowCallRateThreshold=50
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.slowCallDurationThreshold=2s
resilience4j.circuitbreaker.instances.authServiceCircuitBreaker.recordExceptions=java.io.IOException,java.net.ConnectException

resilience4j.circuitbreaker.instances.userServiceCircuitBreaker.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.userServiceCircuitBreaker.slidingWindowSize=100
resilience4j.circuitbreaker.instances.userServiceCircuitBreaker.minimumNumberOfCalls=10
resilience4j.circuitbreaker.instances.userServiceCircuitBreaker.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.userServiceCircuitBreaker.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.userServiceCircuitBreaker.waitDurationInOpenState=60s
resilience4j.circuitbreaker.instances.userServiceCircuitBreaker.failureRateThreshold=50

resilience4j.circuitbreaker.instances.messageServiceCircuitBreaker.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.messageServiceCircuitBreaker.slidingWindowSize=100
resilience4j.circuitbreaker.instances.messageServiceCircuitBreaker.minimumNumberOfCalls=10
resilience4j.circuitbreaker.instances.messageServiceCircuitBreaker.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.messageServiceCircuitBreaker.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.messageServiceCircuitBreaker.waitDurationInOpenState=60s
resilience4j.circuitbreaker.instances.messageServiceCircuitBreaker.failureRateThreshold=50