# Application Configuration
spring.application.name=gateway
spring.profiles.active=${SPRING_PROFILE:local}
server.port=${API_GATEWAY_PORT:7000}

# Netty Configuration
server.netty.connection-timeout=60s
server.compression.enabled=true
server.compression.min-response-size=1024

# Redis Configuration
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.timeout=${REDIS_TIMEOUT:2000ms}
spring.data.redis.password=${REDIS_PASSWORD:strongredispassword}

# Lettuce Connection Pool Configuration
spring.data.redis.lettuce.pool.max-active=20
spring.data.redis.lettuce.pool.max-idle=10
spring.data.redis.lettuce.pool.min-idle=5
spring.data.redis.lettuce.pool.time-between-eviction-runs=60000ms
spring.data.redis.lettuce.shutdown-timeout=100ms

# Gateway HttpClient Configuration
spring.cloud.gateway.server.webflux.httpclient.connect-timeout=60000
spring.cloud.gateway.server.webflux.httpclient.response-timeout=30000
spring.cloud.gateway.server.webflux.httpclient.websocket.max-frame-payload-length=10000000
spring.cloud.gateway.server.webflux.httpclient.websocket.proxy-ping=true

# OAuth2 Resource Server
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=${JWKS_URL:http://localhost:7100/auth/.well-known/jwks.json}

# Eureka Server Configuration
eureka.client.service-url.defaultZone=${EUREKA_SERVER_URL:http://localhost:8761/eureka}

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.prometheus.metrics.export.enabled=true

# Zipkin Configuration
management.tracing.enabled=true
management.tracing.sampling.probability=${ZIPKIN_SAMPLING_RATE:1}
management.zipkin.tracing.endpoint=${ZIPKIN_ENDPOINT:http://localhost:9411/api/v2/spans}

# Resilience4j Circuit Breaker Configuration
resilience4j.circuitbreaker.instances.authCircuitBreaker.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.authCircuitBreaker.slidingWindowSize=100
resilience4j.circuitbreaker.instances.authCircuitBreaker.minimumNumberOfCalls=10
resilience4j.circuitbreaker.instances.authCircuitBreaker.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.authCircuitBreaker.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.authCircuitBreaker.waitDurationInOpenState=60s
resilience4j.circuitbreaker.instances.authCircuitBreaker.failureRateThreshold=50
resilience4j.circuitbreaker.instances.authCircuitBreaker.slowCallRateThreshold=50
resilience4j.circuitbreaker.instances.authCircuitBreaker.slowCallDurationThreshold=10s

resilience4j.circuitbreaker.instances.socketCircuitBreaker.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.socketCircuitBreaker.slidingWindowSize=100
resilience4j.circuitbreaker.instances.socketCircuitBreaker.minimumNumberOfCalls=10
resilience4j.circuitbreaker.instances.socketCircuitBreaker.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.socketCircuitBreaker.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.socketCircuitBreaker.waitDurationInOpenState=60s
resilience4j.circuitbreaker.instances.socketCircuitBreaker.failureRateThreshold=50
